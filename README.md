# Update-VC1.52C-C-C-
Think Microsoft Visual C++ 1.52c's C/C++ support is outdated? Why not give this a try!
# sort.h ä½¿ç”¨æ‰‹å†Œ

## å¤´æ–‡ä»¶
ä½¿ç”¨ `sort.h` æ’åºåº“éœ€è¦åŒ…å«å¤´æ–‡ä»¶ï¼š
```cpp
#include "sort.h"
```

## sort() åŸºæœ¬ä½¿ç”¨æ–¹æ³•

`sort()` å‡½æ•°å¯ä»¥å¯¹ç»™å®šåŒºé—´æ‰€æœ‰å…ƒç´ è¿›è¡Œæ’åºã€‚å®ƒæœ‰ä¸‰ä¸ªå‚æ•° `sort(begin, end, cmp)`ï¼Œå…¶ä¸­ï¼š
- `begin`ï¼šæŒ‡å‘å¾…æ’åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ
- `end`ï¼šæŒ‡å‘å¾…æ’åºæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®çš„æŒ‡é’ˆ  
- `cmp`ï¼šæ’åºå‡†åˆ™å‡½æ•°ï¼ˆå¯é€‰å‚æ•°ï¼‰

å¦‚æœçœç•¥ `cmp` å‚æ•°ï¼Œé»˜è®¤æŒ‰å‡åºè¿›è¡Œæ’åºã€‚

## æ”¯æŒçš„æ•°æ®ç±»å‹

### æ•´æ•°æ•°ç»„æ’åº
```cpp
int arr[] = {5, 2, 8, 1, 9};
int n = sizeof(arr) / sizeof(arr[0]);

// é»˜è®¤å‡åº
sort(arr, arr + n);

// é™åºæ’åº
sort(arr, arr + n, greater_int);
```

### æµ®ç‚¹æ•°æ•°ç»„æ’åº
```cpp
double values[] = {3.14, 2.71, 1.41};
sort(values, values + 3);                    // å‡åº
sort(values, values + 3, greater_double);    // é™åº
```

### å­—ç¬¦ä¸²æ•°ç»„æ’åº
```cpp
const char* names[] = {"Charlie", "Alice", "Bob"};
sort(names, names + 3);                      // å­—å…¸åºå‡åº
sort(names, names + 3, greater_string);      // å­—å…¸åºé™åº
```

## å†…ç½®æ¯”è¾ƒå‡½æ•°

æˆ‘ä»¬æä¾›äº†ä¸€ç³»åˆ—å†…ç½®æ¯”è¾ƒå‡½æ•°ï¼Œç±»ä¼¼ STL çš„ `less` å’Œ `greater`ï¼š

### æ•´æ•°æ¯”è¾ƒ
- `less_int` - å‡åºæ’åº
- `greater_int` - é™åºæ’åº

### æµ®ç‚¹æ•°æ¯”è¾ƒ  
- `less_double` - å‡åºæ’åº
- `greater_double` - é™åºæ’åº

### å­—ç¬¦ä¸²æ¯”è¾ƒ
- `less_string` - å­—å…¸åºå‡åº
- `greater_string` - å­—å…¸åºé™åº

## è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°

æ‚¨å¯ä»¥å®šä¹‰è‡ªå·±çš„æ¯”è¾ƒå‡½æ•°æ¥å®ç°ç‰¹æ®Šæ’åºéœ€æ±‚ï¼š

### æŒ‰ç»å¯¹å€¼æ’åº
```cpp
int compare_abs(const void* a, const void* b) {
    int ia = abs(*(const int*)a);
    int ib = abs(*(const int*)b);
    return (ia < ib) ? -1 : (ia > ib) ? 1 : 0;
}

// ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
sort(arr, arr + n, compare_abs);
```

### æŒ‰å­—ç¬¦ä¸²é•¿åº¦æ’åº
```cpp
int compare_strlen(const void* a, const void* b) {
    int len1 = strlen(*(const char**)a);
    int len2 = strlen(*(const char**)b);
    return (len1 < len2) ? -1 : (len1 > len2) ? 1 : 0;
}

// ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°  
sort(names, names + n, compare_strlen);
```

### å¥‡å¶æ’åºï¼ˆå¥‡æ•°åœ¨å‰ï¼‰
```cpp
int compare_odd_even(const void* a, const void* b) {
    int ia = *(const int*)a;
    int ib = *(const int*)b;
    int a_odd = ia % 2;
    int b_odd = ib % 2;
    
    if (a_odd != b_odd) {
        return (a_odd > b_odd) ? -1 : 1;
    }
    return (ia < ib) ? -1 : (ia > ib) ? 1 : 0;
}

sort(arr, arr + n, compare_odd_even);
```

## é€šç”¨æ’åºå‡½æ•°

å¯¹äºè‡ªå®šä¹‰ç»“æ„ä½“æˆ–å…¶ä»–æ•°æ®ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨é€šç”¨æ’åºå‡½æ•°ï¼š

```cpp
// éœ€è¦æ˜¾å¼æŒ‡å®šå…ƒç´ å¤§å°
sort(begin, end, element_size, compare_function);

// ç¤ºä¾‹ï¼šè‡ªå®šä¹‰ç»“æ„ä½“æ’åº
struct Point {
    int x, y;
};

int compare_point(const void* a, const void* b) {
    Point* p1 = (Point*)a;
    Point* p2 = (Point*)b;
    // æŒ‰xåæ ‡æ’åº
    return (p1->x < p2->x) ? -1 : (p1->x > p2->x) ? 1 : 0;
}

Point points[10];
sort(points, points + 10, sizeof(Point), compare_point);
```

## å®Œæ•´ç¤ºä¾‹

```cpp
#include <iostream.h>
#include "sort.h"

int main() {
    // æ•´æ•°æ•°ç»„æ’åºç¤ºä¾‹
    int numbers[] = {5, 2, 8, 1, 9, 3};
    int n = sizeof(numbers) / sizeof(numbers[0]);
    
    // é»˜è®¤å‡åº
    sort(numbers, numbers + n);
    
    // é™åº
    sort(numbers, numbers + n, greater_int);
    
    return 0;
}
```

## æ³¨æ„äº‹é¡¹

1. **æ¯”è¾ƒå‡½æ•°è¿”å›å€¼**ï¼š
   - è¿”å› `-1` è¡¨ç¤º a < b
   - è¿”å› `0` è¡¨ç¤º a == b  
   - è¿”å› `1` è¡¨ç¤º a > b

2. **æŒ‡é’ˆèŒƒå›´**ï¼š`end` æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®

3. **ç±»å‹å®‰å…¨**ï¼šç¡®ä¿æ¯”è¾ƒå‡½æ•°ä¸æ•°ç»„ç±»å‹åŒ¹é…



# stack.h ä½¿ç”¨æ‰‹å†Œ

## æ¦‚è¿°

stack.h æ˜¯ä¸€ä¸ªä¸“ä¸º VC1.52C ç¯å¢ƒè®¾è®¡çš„ C++ æ ˆåº“ï¼Œæä¾›å®Œæ•´çš„åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰æ•°æ®ç»“æ„æ”¯æŒã€‚å®ƒé‡‡ç”¨ç°ä»£ C++ é£æ ¼è®¾è®¡ï¼Œæ”¯æŒåŠ¨æ€å®¹é‡è°ƒæ•´å’Œç±»å‹å®‰å…¨çš„æ•°æ®å­˜å‚¨ã€‚

## å¿«é€Ÿå…¥é—¨

### åˆ›å»ºæ ˆå¯¹è±¡

ä½¿ç”¨æ ˆå‰éœ€å…ˆå£°æ˜æ ˆå¯¹è±¡ï¼Œå¹¶æŒ‡å®šå­˜å‚¨æ•°æ®ç±»å‹çš„å¤§å°ï¼š

```cpp
stack å˜é‡å(sizeof(æ•°æ®ç±»å‹));
```

**ç¤ºä¾‹ï¼š**
```cpp
stack int_stack(sizeof(int));        // åˆ›å»ºæ•´æ•°æ ˆ
stack double_stack(sizeof(double));  // åˆ›å»ºåŒç²¾åº¦æ ˆ
```

## æ ¸å¿ƒå‡½æ•°è¯¦è§£

### ğŸ“¤ æ•°æ®æ“ä½œå‡½æ•°

#### push() - å‹æ ˆæ“ä½œ
å°†å…ƒç´ æ·»åŠ åˆ°æ ˆé¡¶

**è¯­æ³•ï¼š**
```cpp
bool push(const void* element);
````

**å‚æ•°è¯´æ˜ï¼š**
- elementï¼šæŒ‡å‘è¦å‹å…¥æ•°æ®çš„æŒ‡é’ˆ

**è¿”å›å€¼ï¼š**
- trueï¼šå‹æ ˆæˆåŠŸ
- falseï¼šå‹æ ˆå¤±è´¥ï¼ˆé€šå¸¸å†…å­˜ä¸è¶³ï¼‰

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```cpp
int value = 42;
if (int_stack.push(&value)) {
    cout << "å‹æ ˆæˆåŠŸ" << endl;
}
```

#### pop() - å‡ºæ ˆæ“ä½œ
ç§»é™¤æ ˆé¡¶å…ƒç´ ï¼Œæä¾›ä¸¤ç§é‡è½½å½¢å¼ï¼š

**å½¢å¼1ï¼šä»…ç§»é™¤**
```cpp
bool pop();
```

**å½¢å¼2ï¼šç§»é™¤å¹¶è·å–å€¼**
```cpp
bool pop(void* out_element);
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```cpp
// ä»…ç§»é™¤æ ˆé¡¶å…ƒç´ 
int_stack.pop();

// ç§»é™¤å¹¶è·å–æ ˆé¡¶å…ƒç´ 
int value;
if (int_stack.pop(&value)) {
    cout << "å¼¹å‡ºå€¼ï¼š" << value << endl;
}
```

#### top() - æŸ¥çœ‹æ ˆé¡¶
è·å–æ ˆé¡¶å…ƒç´ ä½†ä¸ç§»é™¤

**è¯­æ³•ï¼š**
```cpp
bool top(void* out_element) const;
```

**é‡è¦æç¤ºï¼š** è°ƒç”¨å‰å¿…é¡»ç¡®ä¿æ ˆéç©º

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```int top_value;
if (int_stack.top(&top_value)) {
    cout << "æ ˆé¡¶å…ƒç´ ï¼š" << top_value << endl;
}
```

### ğŸ“Š çŠ¶æ€æŸ¥è¯¢å‡½æ•°

#### empty() - æ£€æŸ¥ç©ºæ ˆ
åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º

**è¯­æ³•ï¼š**
```cpp
bool empty() const;
```

**è¿”å›å€¼ï¼š**
- trueï¼šæ ˆä¸ºç©º
- falseï¼šæ ˆéç©º

**å…¸å‹åº”ç”¨ï¼š**
```cpp
// å®‰å…¨å‡ºæ ˆå¾ªç¯
while (!stack.empty()) {
    int value;
    stack.pop(&value);
    // å¤„ç†æ•°æ®
}
```

#### size() - è·å–å…ƒç´ æ•°é‡
è¿”å›æ ˆä¸­å½“å‰å…ƒç´ ä¸ªæ•°

**è¯­æ³•ï¼š**
```cpp
size_t size() const;
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```cpp
cout << "æ ˆä¸­å…ƒç´ æ•°é‡ï¼š" << stack.size() << endl;
```

#### capacity() - è·å–å®¹é‡
è¿”å›æ ˆçš„å½“å‰å®¹é‡

**è¯­æ³•ï¼š**
```cpp
size_t capacity() const;
```

**ç”¨é€”ï¼š** ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä¼˜åŒ–æ€§èƒ½

### ğŸ› ï¸ ç®¡ç†å‡½æ•°

#### clear() - æ¸…ç©ºæ ˆ
ç§»é™¤æ ˆä¸­æ‰€æœ‰å…ƒç´ ï¼Œé‡Šæ”¾å†…å­˜

**è¯­æ³•ï¼š**
```cpp
void clear();
```

**æ³¨æ„ï¼š** æ¸…ç©ºåæ ˆå¯¹è±¡ä»ç„¶æœ‰æ•ˆï¼Œå¯ç»§ç»­ä½¿ç”¨

#### reserve() - é¢„ç•™ç©ºé—´
é¢„å…ˆåˆ†é…æŒ‡å®šå®¹é‡çš„å†…å­˜

**è¯­æ³•ï¼š**
```cpp
bool reserve(size_t new_capacity);
```

**ä½¿ç”¨åœºæ™¯ï¼š** å·²çŸ¥æ•°æ®é‡è¾ƒå¤§æ—¶é¢„åˆ†é…ç©ºé—´ï¼Œé¿å…é¢‘ç¹æ‰©å®¹

## å®Œæ•´ä½¿ç”¨æµç¨‹

### æ ‡å‡†ä½¿ç”¨æ¨¡å¼

1. **åˆ›å»ºæ ˆå¯¹è±¡**
2. **å‹å…¥æ•°æ®**ï¼ˆæ£€æŸ¥æ“ä½œæˆåŠŸï¼‰
3. **æŸ¥è¯¢æ ˆçŠ¶æ€**
4. **å¤„ç†æ ˆé¡¶æ•°æ®**
5. **å¼¹å‡ºæ•°æ®**
6. **æ¸…ç©ºæ ˆ**ï¼ˆå¯é€‰ï¼‰

### å®Œæ•´ç¤ºä¾‹

**æ•´æ•°æ ˆæ“ä½œï¼š**
```cpp
#include <iostream.h>
#include "stack.h"

int main() {
    // 1. åˆ›å»ºæ ˆ
    stack number_stack(sizeof(int));
    
    // 2. å‹å…¥æ•°æ®
    for (int i = 1; i <= 5; i++) {
        if (number_stack.push(&i)) {
            cout << "å‹æ ˆï¼š" << i << endl;
        }
    }
    
    // 3. æ£€æŸ¥çŠ¶æ€
    cout << "æ ˆå¤§å°ï¼š" << number_stack.size() 
         << "ï¼Œå®¹é‡ï¼š" << number_stack.capacity() << endl;
    
    // 4. æŸ¥çœ‹æ ˆé¡¶
    int top_value;
    if (number_stack.top(&top_value)) {
        cout << "æ ˆé¡¶å…ƒç´ ï¼š" << top_value << endl;
    }
    
    // 5. å¼¹å‡ºæ•°æ®
    cout << "å‡ºæ ˆé¡ºåºï¼š";
    while (number_stack.pop(&top_value)) {
        cout << top_value << " ";
    }
    cout << endl;
    
    return 0;
}
```

**ç»“æ„ä½“æ ˆæ“ä½œï¼š**
```cpp
struct Point {
    int x, y;
};

stack point_stack(sizeof(Point));
Point p = {10, 20};
point_stack.push(&p);
```

## æœ€ä½³å®è·µæŒ‡å—

### âœ… æ¨èåšæ³•

1. **å§‹ç»ˆæ£€æŸ¥æ“ä½œè¿”å›å€¼**
```cpp
   if (!stack.push(&data)) {
       // å¤„ç†å‹æ ˆå¤±è´¥
   }
```

2. **æ“ä½œå‰æ£€æŸ¥æ ˆçŠ¶æ€**
```cpp
   if (!stack.empty()) {
       stack.top(&value);
   }
```

3. **é¢„åˆ†é…å¤§å®¹é‡**
```cpp
   stack.reserve(1000);  // é¢„åˆ†é…1000ä¸ªå…ƒç´ ç©ºé—´
```

4. **ä½¿ç”¨åŒ¹é…çš„æ•°æ®ç±»å‹**
```cpp
   // æ­£ç¡®ï¼šæ ˆä¸­æ‰€æœ‰å…ƒç´ ç±»å‹ä¸€è‡´
   stack int_stack(sizeof(int));
```

### âŒ é¿å…åšæ³•

1. **åœ¨ç©ºæ ˆä¸Šè°ƒç”¨ top() æˆ– pop()**
2. **å¿½ç•¥ push() è¿”å›å€¼**
3. **æ··ç”¨ä¸åŒæ•°æ®ç±»å‹**
4. **æ‰‹åŠ¨é‡Šæ”¾æ ˆå†…å­˜**ï¼ˆä¾èµ–ææ„å‡½æ•°è‡ªåŠ¨ç®¡ç†ï¼‰

## æ€§èƒ½ç‰¹å¾

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| push() | O(1) | å¹³æ‘Šæ—¶é—´å¤æ‚åº¦ |
| pop() | O(1) | ç›´æ¥æ“ä½œæ ˆé¡¶ |
| top() | O(1) | ç›´æ¥è®¿é—®æ ˆé¡¶ |
| empty() | O(1) | æŒ‡é’ˆæ¯”è¾ƒ |
| size() | O(1) | æŒ‡é’ˆè¿ç®— |

## æ•°å­¦è¡¨ç¤º

æ ˆçš„åŸºæœ¬æ“ä½œå¯ä»¥ç”¨æ•°å­¦ç¬¦å·è¡¨ç¤ºï¼š

- **å‹æ ˆ**ï¼š$S' = S \cup \{e\}$
- **å‡ºæ ˆ**ï¼š$S' = S \setminus \{\text{top}(S)\}$
- **æ ˆå¤§å°**ï¼š$|S|$
- **ç©ºæ ˆ**ï¼š$S = \emptyset$

å…¶ä¸­ $S$ è¡¨ç¤ºæ ˆï¼Œ$e$ è¡¨ç¤ºå…ƒç´ ï¼Œ$\text{top}(S)$ è¡¨ç¤ºæ ˆé¡¶å…ƒç´ ã€‚

## å¸¸è§é—®é¢˜è§£ç­”

### Q: å¦‚ä½•å¤„ç†æ“ä½œå¤±è´¥ï¼Ÿ
A: æ‰€æœ‰å¯èƒ½å¤±è´¥çš„æ“ä½œéƒ½è¿”å› bool å€¼ï¼Œåº”æ£€æŸ¥è¿”å›å€¼å¹¶ç›¸åº”å¤„ç†ã€‚

### Q: æ ˆçš„æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ
A: å—ç³»ç»Ÿå†…å­˜é™åˆ¶ï¼Œä½¿ç”¨è¿œå †å†…å­˜å¯çªç ´ 64KB é™åˆ¶ã€‚

### Q: å¯ä»¥å­˜å‚¨ä¸åŒç±»å‹çš„å…ƒç´ å—ï¼Ÿ
A: ä¸å¯ä»¥ï¼Œæ¯ä¸ªæ ˆåœ¨åˆ›å»ºæ—¶æŒ‡å®šå…ƒç´ å¤§å°ï¼Œå¿…é¡»å­˜å‚¨ç›¸åŒå¤§å°çš„æ•°æ®ç±»å‹ã€‚

### Q: å¦‚ä½•é¿å…å†…å­˜æ³„æ¼ï¼Ÿ
A: æ ˆå¯¹è±¡åœ¨ææ„æ—¶è‡ªåŠ¨é‡Šæ”¾æ‰€æœ‰å†…å­˜ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ã€‚

### Q: æ ˆæ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Ÿ
A: ä¸ï¼Œè¯¥å®ç°ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒéœ€è¦å¤–éƒ¨åŒæ­¥æœºåˆ¶ã€‚

## é€‚ç”¨åœºæ™¯

- ç®—æ³•ä¸­çš„æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰
- è¡¨è¾¾å¼æ±‚å€¼
- å‡½æ•°è°ƒç”¨æ ˆæ¨¡æ‹Ÿ
- æ’¤é”€æ“ä½œå®ç°
- ä»»ä½•éœ€è¦åè¿›å…ˆå‡ºå¤„ç†çš„åœºæ™¯

è¿™ä¸ªæ ˆåº“ä¸º VC1.52C é¡¹ç›®æä¾›äº†å¼ºå¤§è€Œæ˜“ç”¨çš„æ ˆæ•°æ®ç»“æ„æ”¯æŒï¼Œéµå¾ªç°ä»£ C++ è®¾è®¡åŸåˆ™ï¼Œç¡®ä¿ç±»å‹å®‰å…¨å’Œå†…å­˜æ•ˆç‡ã€‚

è¿™ä¸ªæ’åºåº“æä¾›äº†ä¸ C++ STL ç±»ä¼¼çš„æ¥å£ï¼ŒåŒæ—¶é’ˆå¯¹ VC1.52C ç¯å¢ƒè¿›è¡Œäº†ä¼˜åŒ–ï¼Œæ”¯æŒé«˜æ€§èƒ½çš„å¿«é€Ÿæ’åºç®—æ³•ã€‚
